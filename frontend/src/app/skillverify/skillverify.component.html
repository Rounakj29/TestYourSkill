<p-toast />
<!-- <p-card>
  <ng-template #title>Generate Interview Questions</ng-template>
  <form #userRequestForm="ngForm" (ngSubmit)="onSubmit(userRequestForm)"> 
    <div class="p-fluid">
      <div class="p-field">
        <label for="techStack">Tech Stack (comma separated):</label>
        <input pInputText id="techStack" name="TechStack" ngModel required />
      </div>
      <div class="p-field">
        <label for="experience">Experience (years):</label>
        <input pInputNumber id="experience" name="Experience" ngModel min="0" />
      </div>
      <div class="p-field">
        <label for="roleOrCompany">Role or Company:</label>
        <input pInputText id="roleOrCompany" name="RoleOrCompany" ngModel />
      </div>
      <div class="p-field">
        <label for="noOfQuestion">Number of Questions:</label>
        <input
          pInputNumber
          id="noOfQuestion"
          name="NoOfQuestion"
          ngModel
          min="1"
          required
        />
      </div>
      <div class="p-field">
        <label for="additionalRequirements">Additional Requirements:</label>
        <textarea
          pInputTextarea
          id="additionalRequirements"
          name="AdditionalRequirements"
          ngModel
        ></textarea>
      </div>
      <div class="p-field">
        <button pButton type="submit" label="Submit"></button>
      </div>
    </div>
  </form> 
</p-card> -->
<p-card>
  <ng-template #title>Ready for the Challenge?</ng-template>
  <form #userRequestForm="ngForm" (ngSubmit)="onSubmit(userRequestForm)">
    <div class="card flex flex-col gap-4 mb-4">
      <p-inputgroup>
        <p-inputgroup-addon>
          <i class="pi pi-microchip"></i>
        </p-inputgroup-addon>

        <p-floatlabel variant="in">
          <input
            pInputText
            id="Texh_Stack"
            autocomplete="off"
            ngModel
            name="TechStack"
            required
          />
          <label for="Texh_Stack">Tech Stack (Comma Separated)</label>
        </p-floatlabel>
      </p-inputgroup>
        

         <p-inputgroup>
        <p-inputgroup-addon>
          <i class="pi pi-question-circle"></i>
        </p-inputgroup-addon>

        <p-floatlabel variant="in">
          <input
            pInputText
            id="Question_Type"
            autocomplete="off"
            ngModel
            name="QuestionType"
            required
          />
          <label for="Question_Type">Question Type</label>
        </p-floatlabel>
      </p-inputgroup>
      
      <p-inputgroup>
        <p-inputgroup-addon>
          <i class="pi pi-barcode"></i>
        </p-inputgroup-addon>

        <p-floatlabel variant="in">
          <p-inputnumber
            id="Difficulty_Level"
            autocomplete="off"
            ngModel
            name="DifficultyLvl"
            [showButtons]="true" inputId="minmax-buttons" [min]="1" [max]="4" 
             />
          <label for="Difficulty_Level">Difficulty Level (1:Easy, 2:Medium, 3:Hard, 4:Mixed)</label>
        </p-floatlabel>
      </p-inputgroup>
      <!-- <p-inputgroup>
        <div class="flex-auto">
          <label for="experience">Experience (Years)</label>

          <p-floatlabel class="mb-2 block font-bold" variant="in">
            <p-inputnumber
              ngModel
              [showButtons]="true"
              buttonLayout="horizontal"
              inputId="horizontal"
              spinnerMode="horizontal"
              [step]="0.1"
              mode="decimal"
              [min]="0"
              name="Experience"
              [style]="{ width: '100%' }"
            >
              <ng-template #incrementbuttonicon>
                <span class="pi pi-plus"></span>
              </ng-template>
              <ng-template #decrementbuttonicon>
                <span class="pi pi-minus"></span>
              </ng-template>
            </p-inputnumber>
          </p-floatlabel>
        </div>
      </p-inputgroup> -->
      <p-inputgroup>
        <p-inputgroup-addon>
          <i class="pi pi-desktop"></i>
        </p-inputgroup-addon>

        <p-floatlabel variant="in">
          <input
            pInputText
            id="roleOrCompany"
            ngModel
            name="RoleOrCompany"
            autocomplete="off"
          />
          <label for="roleOrCompany">Role Or Company</label>
        </p-floatlabel>
      </p-inputgroup>
      <p-inputgroup class="flex justify-around gap-4">

      <div class="card flex flex-col items-center gap-2">
        <label for="yearsOfExp">Years Of Experience</label>
        <p-knob 
          [(ngModel)]="yearsOfExperience"
          name="Experience"
          valueColor="MediumTurquoise"
          rangeColor="SlateGray"
            [min]="0"
            [max]="70"
          size="100"
        />
        <div class="flex gap-2">
          <p-button
            icon="pi pi-plus"
            (onClick)="yearsOfExperience=yearsOfExperience+1"
            [disabled]="yearsOfExperience >= 70"
            pRipple 
          />
          <p-button
            icon="pi pi-minus"
            (click)="yearsOfExperience=yearsOfExperience-1"
            [disabled]="yearsOfExperience <= 0"
            pRipple
          />
        </div>
      </div>
      <!-- <div class="flex-auto">
        <label for="experience">No of Questions:</label>

        <p-floatlabel class="mb-2 block font-bold" variant="in">
          <p-inputnumber
            ngModel
            [showButtons]="true"
            buttonLayout="horizontal"
            inputId="horizontal"
            spinnerMode="horizontal"
            [step]="1"
            mode="decimal"
            [min]="1"
            name="NoOfQuestion"
            [style]="{ width: '100%' }"
          >
            <ng-template #incrementbuttonicon>
              <span class="pi pi-plus"></span>
            </ng-template>
            <ng-template #decrementbuttonicon>
              <span class="pi pi-minus"></span>
            </ng-template>
          </p-inputnumber>
        </p-floatlabel>
      </div> -->
      <div class="card flex flex-col items-center gap-2">
        <label for="noOfQuestions">No of Questions</label>
        <p-knob 
            pButtonLabel="No of Questions"
          [(ngModel)]="noOfQuestions"
          name="NoOfQuestion"
          valueColor="MediumTurquoise"
          rangeColor="SlateGray"
            [min]="0"
            [max]="50"
          size="100"
        />
        <div class="flex gap-2">
          <p-button

            icon="pi pi-plus"
            (onClick)="OnYes()"
            [disabled]="noOfQuestions >= 50"
            pRipple
          />
          <p-button
            icon="pi pi-minus"
            (click)="OnNo()"
            [disabled]="noOfQuestions <= 0"
            pRipple
          />
        </div>
      </div>
      </p-inputgroup>
      <p-floatlabel variant="in">
        <textarea
          rows="5"
          cols="30"
          pTextarea
          [autoResize]="true"
          id="over_label"
          ngModel
          pSize="large"
          style="resize: none"
          class="w-full"
          name="AdditionalRequirements"
        ></textarea>
        <label for="in_label">Additional Requirements</label>
      </p-floatlabel>
    </div>

    
    <div class="p-field">
      <button pButton type="submit" pRipple  label="Submit"></button>
    </div>
  </form>
</p-card>



<p-card *ngIf="questions.length" class="mt-8">
  <ng-template #title>Generated Questions</ng-template>
  <div id="results">
    <div *ngIf="error" class="p-error">{{ error }}</div>
    <div *ngIf="questions.length">
      <div *ngFor="let q of questions" class="question">
        <div class="type-label">
          [{{ q.type }}] Question #{{ q.question_no }}
        </div>
        <div>
          <strong class="whitespace-break-spaces">{{ q.question }}</strong>
        </div>
        <ul *ngIf="q.type === 'MCQ' && q.options?.length" class="mcq-options">
          <li *ngFor="let opt of q.options">{{ opt }}</li>
        </ul>
        <div *ngIf="q.type === 'Code' && q.code_snippet" class="code-block">
          <pre>{{ q.code_snippet }}</pre>
        </div>
        <div *ngIf="q.explanation">
          <em>Explanation:</em> {{ q.explanation }}
        </div>
        <div *ngIf="q.answer">
          <div><em>How to answer:</em> {{ q.answer.how_to_answer || "" }}</div>
          <div><em>Answer:</em> {{ q.answer.answer_text || "" }}</div>
        </div>
        <div *ngIf="q.difficulty"><em>Difficulty:</em> {{ q.difficulty }}</div>
        <div *ngIf="q.tags?.length"><em>Tags:</em> {{ q.tags.join(", ") }}</div>
      </div>
    </div>
  </div>
</p-card>
<div class="card flex justify-center">
  <p-progress-spinner
    *ngIf="isLoading"
    strokeWidth="8"
    fill="transparent"
    animationDuration=".5s"
    [style]="{ width: '50px', height: '50px' }"
  />
</div>
